<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />

<meta name="author" content="Michael Braun" />

<meta name="date" content="2015-03-30" />

<title>bayesGDS small test example 1</title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; }
code > span.dt { color: #902000; }
code > span.dv { color: #40a070; }
code > span.bn { color: #40a070; }
code > span.fl { color: #40a070; }
code > span.ch { color: #4070a0; }
code > span.st { color: #4070a0; }
code > span.co { color: #60a0b0; font-style: italic; }
code > span.ot { color: #007020; }
code > span.al { color: #ff0000; font-weight: bold; }
code > span.fu { color: #06287e; }
code > span.er { color: #ff0000; font-weight: bold; }
</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>


<link href="data:text/css,body%20%7B%0A%20%20background%2Dcolor%3A%20%23fff%3B%0A%20%20margin%3A%201em%20auto%3B%0A%20%20max%2Dwidth%3A%20700px%3B%0A%20%20overflow%3A%20visible%3B%0A%20%20padding%2Dleft%3A%202em%3B%0A%20%20padding%2Dright%3A%202em%3B%0A%20%20font%2Dfamily%3A%20%22Open%20Sans%22%2C%20%22Helvetica%20Neue%22%2C%20Helvetica%2C%20Arial%2C%20sans%2Dserif%3B%0A%20%20font%2Dsize%3A%2014px%3B%0A%20%20line%2Dheight%3A%201%2E35%3B%0A%7D%0A%0A%23header%20%7B%0A%20%20text%2Dalign%3A%20center%3B%0A%7D%0A%0A%23TOC%20%7B%0A%20%20clear%3A%20both%3B%0A%20%20margin%3A%200%200%2010px%2010px%3B%0A%20%20padding%3A%204px%3B%0A%20%20width%3A%20400px%3B%0A%20%20border%3A%201px%20solid%20%23CCCCCC%3B%0A%20%20border%2Dradius%3A%205px%3B%0A%0A%20%20background%2Dcolor%3A%20%23f6f6f6%3B%0A%20%20font%2Dsize%3A%2013px%3B%0A%20%20line%2Dheight%3A%201%2E3%3B%0A%7D%0A%20%20%23TOC%20%2Etoctitle%20%7B%0A%20%20%20%20font%2Dweight%3A%20bold%3B%0A%20%20%20%20font%2Dsize%3A%2015px%3B%0A%20%20%20%20margin%2Dleft%3A%205px%3B%0A%20%20%7D%0A%0A%20%20%23TOC%20ul%20%7B%0A%20%20%20%20padding%2Dleft%3A%2040px%3B%0A%20%20%20%20margin%2Dleft%3A%20%2D1%2E5em%3B%0A%20%20%20%20margin%2Dtop%3A%205px%3B%0A%20%20%20%20margin%2Dbottom%3A%205px%3B%0A%20%20%7D%0A%20%20%23TOC%20ul%20ul%20%7B%0A%20%20%20%20margin%2Dleft%3A%20%2D2em%3B%0A%20%20%7D%0A%20%20%23TOC%20li%20%7B%0A%20%20%20%20line%2Dheight%3A%2016px%3B%0A%20%20%7D%0A%0Atable%20%7B%0A%20%20margin%3A%201em%20auto%3B%0A%20%20border%2Dwidth%3A%201px%3B%0A%20%20border%2Dcolor%3A%20%23DDDDDD%3B%0A%20%20border%2Dstyle%3A%20outset%3B%0A%20%20border%2Dcollapse%3A%20collapse%3B%0A%7D%0Atable%20th%20%7B%0A%20%20border%2Dwidth%3A%202px%3B%0A%20%20padding%3A%205px%3B%0A%20%20border%2Dstyle%3A%20inset%3B%0A%7D%0Atable%20td%20%7B%0A%20%20border%2Dwidth%3A%201px%3B%0A%20%20border%2Dstyle%3A%20inset%3B%0A%20%20line%2Dheight%3A%2018px%3B%0A%20%20padding%3A%205px%205px%3B%0A%7D%0Atable%2C%20table%20th%2C%20table%20td%20%7B%0A%20%20border%2Dleft%2Dstyle%3A%20none%3B%0A%20%20border%2Dright%2Dstyle%3A%20none%3B%0A%7D%0Atable%20thead%2C%20table%20tr%2Eeven%20%7B%0A%20%20background%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0A%0Ap%20%7B%0A%20%20margin%3A%200%2E5em%200%3B%0A%7D%0A%0Ablockquote%20%7B%0A%20%20background%2Dcolor%3A%20%23f6f6f6%3B%0A%20%20padding%3A%200%2E25em%200%2E75em%3B%0A%7D%0A%0Ahr%20%7B%0A%20%20border%2Dstyle%3A%20solid%3B%0A%20%20border%3A%20none%3B%0A%20%20border%2Dtop%3A%201px%20solid%20%23777%3B%0A%20%20margin%3A%2028px%200%3B%0A%7D%0A%0Adl%20%7B%0A%20%20margin%2Dleft%3A%200%3B%0A%7D%0A%20%20dl%20dd%20%7B%0A%20%20%20%20margin%2Dbottom%3A%2013px%3B%0A%20%20%20%20margin%2Dleft%3A%2013px%3B%0A%20%20%7D%0A%20%20dl%20dt%20%7B%0A%20%20%20%20font%2Dweight%3A%20bold%3B%0A%20%20%7D%0A%0Aul%20%7B%0A%20%20margin%2Dtop%3A%200%3B%0A%7D%0A%20%20ul%20li%20%7B%0A%20%20%20%20list%2Dstyle%3A%20circle%20outside%3B%0A%20%20%7D%0A%20%20ul%20ul%20%7B%0A%20%20%20%20margin%2Dbottom%3A%200%3B%0A%20%20%7D%0A%0Apre%2C%20code%20%7B%0A%20%20background%2Dcolor%3A%20%23f7f7f7%3B%0A%20%20border%2Dradius%3A%203px%3B%0A%20%20color%3A%20%23333%3B%0A%7D%0Apre%20%7B%0A%20%20white%2Dspace%3A%20pre%2Dwrap%3B%20%20%20%20%2F%2A%20Wrap%20long%20lines%20%2A%2F%0A%20%20border%2Dradius%3A%203px%3B%0A%20%20margin%3A%205px%200px%2010px%200px%3B%0A%20%20padding%3A%2010px%3B%0A%7D%0Apre%3Anot%28%5Bclass%5D%29%20%7B%0A%20%20background%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0A%0Acode%20%7B%0A%20%20font%2Dfamily%3A%20Consolas%2C%20Monaco%2C%20%27Courier%20New%27%2C%20monospace%3B%0A%20%20font%2Dsize%3A%2085%25%3B%0A%7D%0Ap%20%3E%20code%2C%20li%20%3E%20code%20%7B%0A%20%20padding%3A%202px%200px%3B%0A%7D%0A%0Adiv%2Efigure%20%7B%0A%20%20text%2Dalign%3A%20center%3B%0A%7D%0Aimg%20%7B%0A%20%20background%2Dcolor%3A%20%23FFFFFF%3B%0A%20%20padding%3A%202px%3B%0A%20%20border%3A%201px%20solid%20%23DDDDDD%3B%0A%20%20border%2Dradius%3A%203px%3B%0A%20%20border%3A%201px%20solid%20%23CCCCCC%3B%0A%20%20margin%3A%200%205px%3B%0A%7D%0A%0Ah1%20%7B%0A%20%20margin%2Dtop%3A%200%3B%0A%20%20font%2Dsize%3A%2035px%3B%0A%20%20line%2Dheight%3A%2040px%3B%0A%7D%0A%0Ah2%20%7B%0A%20%20border%2Dbottom%3A%204px%20solid%20%23f7f7f7%3B%0A%20%20padding%2Dtop%3A%2010px%3B%0A%20%20padding%2Dbottom%3A%202px%3B%0A%20%20font%2Dsize%3A%20145%25%3B%0A%7D%0A%0Ah3%20%7B%0A%20%20border%2Dbottom%3A%202px%20solid%20%23f7f7f7%3B%0A%20%20padding%2Dtop%3A%2010px%3B%0A%20%20font%2Dsize%3A%20120%25%3B%0A%7D%0A%0Ah4%20%7B%0A%20%20border%2Dbottom%3A%201px%20solid%20%23f7f7f7%3B%0A%20%20margin%2Dleft%3A%208px%3B%0A%20%20font%2Dsize%3A%20105%25%3B%0A%7D%0A%0Ah5%2C%20h6%20%7B%0A%20%20border%2Dbottom%3A%201px%20solid%20%23ccc%3B%0A%20%20font%2Dsize%3A%20105%25%3B%0A%7D%0A%0Aa%20%7B%0A%20%20color%3A%20%230033dd%3B%0A%20%20text%2Ddecoration%3A%20none%3B%0A%7D%0A%20%20a%3Ahover%20%7B%0A%20%20%20%20color%3A%20%236666ff%3B%20%7D%0A%20%20a%3Avisited%20%7B%0A%20%20%20%20color%3A%20%23800080%3B%20%7D%0A%20%20a%3Avisited%3Ahover%20%7B%0A%20%20%20%20color%3A%20%23BB00BB%3B%20%7D%0A%20%20a%5Bhref%5E%3D%22http%3A%22%5D%20%7B%0A%20%20%20%20text%2Ddecoration%3A%20underline%3B%20%7D%0A%20%20a%5Bhref%5E%3D%22https%3A%22%5D%20%7B%0A%20%20%20%20text%2Ddecoration%3A%20underline%3B%20%7D%0A%0A%2F%2A%20Class%20described%20in%20https%3A%2F%2Fbenjeffrey%2Ecom%2Fposts%2Fpandoc%2Dsyntax%2Dhighlighting%2Dcss%0A%20%20%20Colours%20from%20https%3A%2F%2Fgist%2Egithub%2Ecom%2Frobsimmons%2F1172277%20%2A%2F%0A%0Acode%20%3E%20span%2Ekw%20%7B%20color%3A%20%23555%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%2F%2A%20Keyword%20%2A%2F%0Acode%20%3E%20span%2Edt%20%7B%20color%3A%20%23902000%3B%20%7D%20%2F%2A%20DataType%20%2A%2F%0Acode%20%3E%20span%2Edv%20%7B%20color%3A%20%2340a070%3B%20%7D%20%2F%2A%20DecVal%20%28decimal%20values%29%20%2A%2F%0Acode%20%3E%20span%2Ebn%20%7B%20color%3A%20%23d14%3B%20%7D%20%2F%2A%20BaseN%20%2A%2F%0Acode%20%3E%20span%2Efl%20%7B%20color%3A%20%23d14%3B%20%7D%20%2F%2A%20Float%20%2A%2F%0Acode%20%3E%20span%2Ech%20%7B%20color%3A%20%23d14%3B%20%7D%20%2F%2A%20Char%20%2A%2F%0Acode%20%3E%20span%2Est%20%7B%20color%3A%20%23d14%3B%20%7D%20%2F%2A%20String%20%2A%2F%0Acode%20%3E%20span%2Eco%20%7B%20color%3A%20%23888888%3B%20font%2Dstyle%3A%20italic%3B%20%7D%20%2F%2A%20Comment%20%2A%2F%0Acode%20%3E%20span%2Eot%20%7B%20color%3A%20%23007020%3B%20%7D%20%2F%2A%20OtherToken%20%2A%2F%0Acode%20%3E%20span%2Eal%20%7B%20color%3A%20%23ff0000%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%2F%2A%20AlertToken%20%2A%2F%0Acode%20%3E%20span%2Efu%20%7B%20color%3A%20%23900%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%2F%2A%20Function%20calls%20%2A%2F%20%0Acode%20%3E%20span%2Eer%20%7B%20color%3A%20%23a61717%3B%20background%2Dcolor%3A%20%23e3d2d2%3B%20%7D%20%2F%2A%20ErrorTok%20%2A%2F%0A%0A" rel="stylesheet" type="text/css" />

</head>

<body>



<div id="header">
<h1 class="title">bayesGDS small test example 1</h1>
<h4 class="author"><em>Michael Braun</em></h4>
<h4 class="date"><em>March 30, 2015</em></h4>
</div>


<p>This vignette is a test case of how to use the Braun and Damien (2015) algorithm to estimate a univariate posterior distribution. The other vignettes provide more detailed explanations about how to use the <em>bayesGDS</em> package.</p>
<p>First, let’s load some packages we need. We will use <em>MCMCpack</em> to compare results with an MCMC simulation, and to evaluate an inverse gamma prior.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">require</span>(reshape2)
<span class="kw">require</span>(plyr)
<span class="kw">require</span>(dplyr)
<span class="kw">require</span>(mvtnorm)
<span class="kw">require</span>(MCMCpack)
<span class="kw">require</span>(bayesGDS)
<span class="kw">set.seed</span>(<span class="dv">1234</span>)</code></pre>
<p>The model is</p>
<p><span class="math">\[
x\sim N(\mu, \sigma^2)\\
\mu\sim N(\mu_0, s_0)\\
\sigma^{-2} \sim InvGamma(a, b)\\
\]</span></p>
<p>The simulated dataset is 20 observations of <span class="math">\(x\)</span>. The true mean of <span class="math">\(x\)</span> is <span class="math">\(\mu=100\)</span>, and the standard deviation is <span class="math">\(\sigma=5\)</span>.</p>
<pre class="sourceCode r"><code class="sourceCode r">mu &lt;-<span class="st"> </span><span class="dv">100</span>
sigma &lt;-<span class="st"> </span><span class="dv">5</span>
x &lt;-<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">20</span>, <span class="dt">mean=</span>mu, <span class="dt">sd=</span>sigma)
nX &lt;-<span class="st"> </span><span class="kw">length</span>(x)</code></pre>
<p>The values for the prior parameters are:</p>
<pre class="sourceCode r"><code class="sourceCode r">mu0 &lt;-<span class="st"> </span><span class="dv">0</span>
s0 &lt;-<span class="st"> </span><span class="dv">1000</span>
a &lt;-<span class="st"> </span>.<span class="dv">0001</span>
b &lt;-<span class="st"> </span>.<span class="dv">0001</span></code></pre>
<p>The log data likelihood, log prior, and log posterior are computed by the following functions. Since <span class="math">\(\sigma\)</span> must be positive, we estimate <span class="math">\(\log\sigma\)</span> instead. The factory function <code>makeLogPosterior</code> returns a closure <code>logPosterior</code>, which is a function that takes only the variables of interest as the lone argument. This approach simplifies life because we will not have to pass the prior parameters at subsequent function calls.</p>
<pre class="sourceCode r"><code class="sourceCode r">logL &lt;-<span class="st"> </span>function(theta){
    <span class="kw">sum</span>(<span class="kw">dnorm</span>(x, <span class="dt">mean=</span>theta[<span class="dv">1</span>], <span class="dt">sd=</span><span class="kw">exp</span>(theta[<span class="dv">2</span>]), <span class="dt">log=</span><span class="ot">TRUE</span>))
}

logPrior &lt;-<span class="st"> </span>function(theta, mu0, s0, a, b){
    r1 &lt;-<span class="st"> </span><span class="kw">dnorm</span>(theta[<span class="dv">1</span>], <span class="dt">mean=</span>mu0, <span class="dt">sd=</span>s0, <span class="dt">log=</span><span class="ot">TRUE</span>)
    r2 &lt;-<span class="st"> </span>MCMCpack::<span class="kw">dinvgamma</span>(<span class="kw">exp</span>(<span class="dv">2</span>*theta[<span class="dv">2</span>]), a, b)
    res &lt;-<span class="st"> </span>r1 +<span class="st"> </span>r2 +<span class="st"> </span>theta[<span class="dv">2</span>]
    <span class="kw">return</span>(res)
}

makeLogPosterior &lt;-<span class="st"> </span>function(...) {
    function(theta){ <span class="kw">logL</span>(theta) +<span class="st"> </span><span class="kw">logPrior</span>(theta, ...)}
}

logPosterior &lt;-<span class="st"> </span><span class="kw">makeLogPosterior</span>(<span class="dt">mu0=</span>mu0, <span class="dt">s0=</span>s0, <span class="dt">a=</span>a, <span class="dt">b=</span>b)</code></pre>
<div id="running-the-algorithm" class="section level1">
<h1>Running the algorithm</h1>
<p>The first phase of the algorithm is to find the posterior mode <span class="math">\(\theta^*\)</span>. The Hessian at the mode is <span class="math">\(H^*\)</span>. Since we are actually minimizing the negative log posterior, the Hessian will be positive definite at the optimum.</p>
<pre class="sourceCode r"><code class="sourceCode r">theta0 &lt;-<span class="st"> </span><span class="kw">c</span>( <span class="kw">mean</span>(x), <span class="kw">log</span>(<span class="kw">sd</span>(x)) )
fit0 &lt;-<span class="st"> </span><span class="kw">optim</span>(theta0,
              <span class="dt">fn =</span> function(th) {-<span class="kw">logPosterior</span>(th)},
              <span class="dt">hessian=</span><span class="ot">TRUE</span>
              )

theta.star &lt;-<span class="st"> </span>fit0$par ## posterior mode
H.star &lt;-<span class="st"> </span>fit0$hessian
H.star.inverse &lt;-<span class="st"> </span><span class="kw">solve</span>(fit0$hessian)
log.c1 &lt;-<span class="st"> </span><span class="kw">logPosterior</span>(theta.star)</code></pre>
<p>Next, we sample <span class="math">\(M\)</span> values from a proposal distribution <span class="math">\(g(\theta)\)</span>. We will use a multivariate normal distribution with mean <span class="math">\(\theta^*\)</span>, and covariance <span class="math">\(sH^{-1*}\)</span>. The scalar <span class="math">\(s\)</span> is a scaling function to ensure that the proposal distribution is valid.</p>
<p>We set <span class="math">\(s=2.9\)</span>, which is the smallest value that generates a valid proposal. We found this value by adaptive search (i.e., “trial and error”). Larger values have no substantial effect on the results, but the acceptance rate of the sampler is lower.</p>
<p>The <code>sample.GDS</code> function requires the proposal functions to take distribution parameters as a single list, so we need to write some wrapper functions.</p>
<pre class="sourceCode r"><code class="sourceCode r">## proposal functions
logg &lt;-<span class="st"> </span>function(theta, prop.params){
    <span class="kw">dmvnorm</span>(theta,
            <span class="dt">mean=</span>prop.params[[<span class="dv">1</span>]], <span class="dt">sigma=</span>prop.params[[<span class="dv">2</span>]],
            <span class="dt">log=</span><span class="ot">TRUE</span>)
}
drawg &lt;-<span class="st"> </span>function(N, prop.params) {
    <span class="kw">rmvnorm</span>(N, <span class="dt">mean=</span>prop.params[[<span class="dv">1</span>]],
            <span class="dt">sigma =</span> prop.params[[<span class="dv">2</span>]]
            )
}
M &lt;-<span class="st"> </span><span class="dv">50000</span>
s &lt;-<span class="st"> </span><span class="fl">2.9</span>
log.c2 &lt;-<span class="st"> </span><span class="kw">logg</span>(theta.star, <span class="dt">prop.params=</span><span class="kw">list</span>(theta.star, s*H.star.inverse))
prop.params &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="dt">mean=</span>theta.star,
                    <span class="dt">sigma =</span> s*H.star.inverse
                    )

thetaM &lt;-<span class="st"> </span><span class="kw">drawg</span>(M, prop.params)
log.post.m &lt;-<span class="st"> </span><span class="kw">apply</span>(thetaM, <span class="dv">1</span>, logPosterior)
log.prop.m &lt;-<span class="st"> </span><span class="kw">apply</span>(thetaM, <span class="dv">1</span>, logg, <span class="dt">prop.params=</span>prop.params)
log.phi &lt;-<span class="st"> </span>log.post.m -<span class="st"> </span>log.prop.m +<span class="st"> </span>log.c2 -<span class="st"> </span>log.c1
valid.scale &lt;-<span class="st"> </span><span class="kw">all</span>(log.phi &lt;=<span class="st"> </span><span class="dv">0</span>)
<span class="kw">stopifnot</span>(valid.scale)</code></pre>
<p>Now, we can sample from the posterior.</p>
<pre class="sourceCode r"><code class="sourceCode r">n.draws &lt;-<span class="st"> </span><span class="dv">1000</span>
draws &lt;-<span class="st"> </span><span class="kw">sample.GDS</span>(<span class="dt">n.draws =</span> n.draws,
                    <span class="dt">log.phi =</span> log.phi,
                    <span class="dt">post.mode =</span> theta.star,
                    <span class="dt">fn.dens.post =</span> logPosterior,
                    <span class="dt">fn.dens.prop =</span> logg,
                    <span class="dt">fn.draw.prop =</span> drawg,
                    <span class="dt">prop.params =</span> prop.params,
                    <span class="dt">announce=</span><span class="ot">FALSE</span>,
                    <span class="dt">report.freq =</span> <span class="dv">1000</span>
                    )
<span class="kw">dimnames</span>(draws$draws) &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="dt">draw=</span><span class="dv">1</span>:n.draws, <span class="dt">var=</span><span class="kw">c</span>(<span class="st">&quot;mu&quot;</span>,<span class="st">&quot;log.sigma&quot;</span>))
fr1 &lt;-<span class="st"> </span><span class="kw">data.frame</span>(draws$draws) %&gt;%
<span class="st">  </span>dplyr::<span class="kw">mutate</span>(<span class="dt">method=</span><span class="st">&quot;BD&quot;</span>, <span class="dt">sigma=</span><span class="kw">exp</span>(<span class="dv">2</span>*log.sigma)) %&gt;%
<span class="st">  </span>dplyr::<span class="kw">select</span>(-log.sigma)</code></pre>
</div>
<div id="checking-results" class="section level1">
<h1>Checking results</h1>
<p>The posterior distribution does not have an analytic form, but we can compare what we get to MCMC results. The quantiles are reasonably close.</p>
<pre class="sourceCode r"><code class="sourceCode r">fit.mcmc &lt;-<span class="st"> </span><span class="kw">MCMCregress</span>(x~(<span class="dv">1</span>), <span class="dt">mcmc=</span><span class="dv">10000</span>,<span class="dt">burnin=</span><span class="dv">5000</span>,
                        <span class="dt">b0 =</span> mu0, <span class="dt">B0 =</span> <span class="dv">1</span>/(s0^<span class="dv">2</span>),
                        <span class="dt">c0=</span><span class="dv">2</span>*a, <span class="dt">d0=</span><span class="dv">2</span>*b)
<span class="kw">dimnames</span>(fit.mcmc) &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="dt">draw=</span><span class="dv">1</span>:<span class="kw">NROW</span>(fit.mcmc), <span class="dt">var=</span><span class="kw">c</span>(<span class="st">&quot;mu&quot;</span>,<span class="st">&quot;sigma&quot;</span>))
fr2 &lt;-<span class="st"> </span><span class="kw">data.frame</span>(fit.mcmc) %&gt;%<span class="st"> </span><span class="kw">mutate</span>(<span class="dt">method=</span><span class="st">&quot;MCMC&quot;</span>)
fr &lt;-<span class="st"> </span><span class="kw">rbind</span>(<span class="kw">melt</span>(fr1), <span class="kw">melt</span>(fr2))</code></pre>
<pre><code>## Using method as id variables
## Using method as id variables</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">quants &lt;-<span class="st"> </span><span class="kw">ddply</span>(fr,<span class="kw">c</span>(<span class="st">&quot;variable&quot;</span>,<span class="st">&quot;method&quot;</span>),
                function(X) <span class="kw">quantile</span>(X$value, <span class="dt">probs=</span><span class="kw">c</span>(.<span class="dv">05</span>,.<span class="dv">25</span>,.<span class="dv">5</span>,.<span class="dv">75</span>,.<span class="dv">95</span>)))
knitr::<span class="kw">kable</span>(quants)</code></pre>
<table>
<thead>
<tr class="header">
<th align="left">variable</th>
<th align="left">method</th>
<th align="right">5%</th>
<th align="right">25%</th>
<th align="right">50%</th>
<th align="right">75%</th>
<th align="right">95%</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">mu</td>
<td align="left">BD</td>
<td align="right">96.784</td>
<td align="right">97.976</td>
<td align="right">98.762</td>
<td align="right">99.556</td>
<td align="right">100.730</td>
</tr>
<tr class="even">
<td align="left">mu</td>
<td align="left">MCMC</td>
<td align="right">96.737</td>
<td align="right">97.971</td>
<td align="right">98.755</td>
<td align="right">99.515</td>
<td align="right">100.683</td>
</tr>
<tr class="odd">
<td align="left">sigma</td>
<td align="left">BD</td>
<td align="right">17.123</td>
<td align="right">22.225</td>
<td align="right">28.508</td>
<td align="right">35.870</td>
<td align="right">52.579</td>
</tr>
<tr class="even">
<td align="left">sigma</td>
<td align="left">MCMC</td>
<td align="right">16.256</td>
<td align="right">21.356</td>
<td align="right">26.696</td>
<td align="right">33.646</td>
<td align="right">48.841</td>
</tr>
</tbody>
</table>
</div>



<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
